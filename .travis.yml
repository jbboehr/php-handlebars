
dist: bionic

matrix:
  fast_finish: true
  allow_failures:
  - php: 'master'
  include:
# basic
  - language: php
    php: '7.2'
  - language: php
    php: '7.3'
  - language: php
    php: '7.4'
  - language: php
    php: 'master'
# no hardening
  - language: php
    php: '7.4'
    env:
    - HARDENING=false
# ast + psr
  - language: php
    php: '7.2'
    env:
    - AST=true
    - PHP_PSR_VERSION=v1.0.0
  - language: php
    php: '7.3'
    env:
    - AST=true
    - PHP_PSR_VERSION=v1.0.0
  - language: php
    php: '7.4'
    env:
    - AST=true
    - PHP_PSR_VERSION=v1.0.0
  - language: php
    php: 'master'
    env:
    - AST=true
    - PHP_PSR_VERSION=v1.0.0
# fedora
  - services:
    - docker
    env:
    - DOCKER_IMAGE=fedora31

env:
  global:
  - LIBHANDLEBARS_VERSION=6c50d111287cf669edc48dab6b265b68ad01a4bf

branches:
    only:
    - master
    - develop
    - travis
    - dev-1.x

addons:
  apt:
    packages:
    - bison
    - check
    - flex
    - gperf
    - lcov
    - libjson-c-dev
    - liblmdb-dev
    - libpcre3-dev
    - libtalloc-dev
    - libyaml-dev
    - re2c
    - valgrind

before_install:
  - source ./.ci/travis_env.sh
  - before_install
install: install
before_script: before_script
script: script
after_success: after_success
after_failure: after_failure
